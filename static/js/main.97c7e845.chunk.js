(this.webpackJsonpschematize=this.webpackJsonpschematize||[]).push([[0],{104:function(e,t,n){"use strict";n.r(t);var o=n(0),r=n.n(o),s=n(43),a=n.n(s),i=(n(52),n(17)),l=n(15),p=n(16),c=n(7),h=n(8),u=n(11),d=n(10),m=n(9),g=n(12),f=(n(42),n(1)),v=n(30),b=n.n(v),y=n(44);function k(e){if(""===e)return!1;var t=new XMLHttpRequest;return t.open("HEAD",e,!1),t.send(),404!==t.status}function C(){return(C=Object(y.a)(b.a.mark((function e(t,n){var o;return b.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return(o=new XMLHttpRequest).onreadystatechange=function(){4===o.readyState&&200===o.status&&n(o.responseText)},e.next=4,o.open("GET",t,!0);case 4:o.send(null);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var x=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e){var o;return Object(c.a)(this,n),(o=t.call(this,e)).pathNames=[],o.components=[],o.jsonCache={},o.nucleotides=[],o.metadata=[],o.loadIndexFile(o.props.store.jsonName),o.loadMetadataFile(o.props.store.jsonName),Object(f.s)(o.props.store,"jsonName",(function(){o.loadIndexFile(o.props.store.jsonName),o.loadMetadataFile(o.props.store.jsonName)})),Object(f.s)(o.props.store.chunkFastaURLs,(function(){o.loadFasta()})),o}return Object(h.a)(n,[{key:"componentDidUpdate",value:function(){}},{key:"loadIndexFile",value:function(e){var t=this;console.log("STEP #1: whenever jsonName changes, loadIndexFile");var n="https://collections.lugli.arvadosapi.com/c=lugli-4zz18-8byz5m8v3udnj8a/t=1km3sd1jsgrj3pr5n4pp7raza4djg72tygcg3dym3ta1ty3ewx/_/"+e+"/bin2file.json";return fetch(n).then((function(e){return e.json()})).then((function(e){console.log("loadIndexFile - END reading",n),t.props.store.setChunkIndex(e)}))}},{key:"jsonFetch",value:function(e){if(!e)throw new Error("No filepath given. Ensure chunknames in bin2file.json are correct.");return console.log("Fetching",e),fetch(e).then((function(e){return e.json()}))}},{key:"loadJsonCache",value:function(e,t){if(console.log("STEP #6: fetched chunks go into loadJsonCache"),17!==t.json_version)throw MediaError("Wrong Data JSON version: was expecting version 17, got "+t.json_version+".  This version added x and compressedX fields for the chunks too.  Using a mismatched data file and renderer will cause unpredictable behavior, instead generate a new data file using github.com/graph-genome/component_segmentation.");this.jsonCache[e]=t,this.pathNames=t.path_names,this.processArray()}},{key:"loadFasta",value:function(){var e=this;console.log("loadFasta"),this.nucleotides=[];var t,n=Object(l.a)(this.props.store.chunkFastaURLs);try{var o=function(){var n=t.value;k(n)&&fetch(n).then((function(e){return e.text()})).then((function(t){var o,r=t.replace(/.*/,"").substr(1).replace(/[\r\n]+/gm,"");(o=e.nucleotides).push.apply(o,Object(i.a)(r)),e.props.store.addChunkProcessedFasta(n)}))};for(n.s();!(t=n.n()).done;)o()}catch(r){n.e(r)}finally{n.f()}}},{key:"loadMetadataFile",value:function(e){var t=this,n="https://collections.lugli.arvadosapi.com/c=lugli-4zz18-8byz5m8v3udnj8a/t=1km3sd1jsgrj3pr5n4pp7raza4djg72tygcg3dym3ta1ty3ewx/_/"+e+"/metadata.json";if(console.log("loadMetadataFile: ",n),k(n))return console.log("Reading metadata"),fetch(n).then((function(e){return e.json()})).then((function(e){for(var n={},o=0;o<e.length;o++)n[e[o][t.props.store.metaDataKey]]=e[o];t.props.store.setMetaData(n)}))}},{key:"processArray",value:function(){console.log("STEP #7: JsonCache causes processArray to update chunksProcessed");var e=this.props.store;0!==e.chunksProcessed.length&&e.chunksProcessed[0]===e.chunkURLs[0]||(this.components=[]);for(var t=0;t<e.chunkURLs.length;t++)if(t>=e.chunksProcessed.length){if(!(e.chunkURLs[t]in this.jsonCache))return!1;var n,o=e.chunkURLs[t],r=this.jsonCache[o],s=this.components.length>0?this.components[this.components.length-1].index+1:0,a=Object(l.a)(r.components.entries());try{for(a.s();!(n=a.n()).done;){var i=Object(p.a)(n.value,2),c=i[0],h=i[1];if(h.first_bin>0){var u=new O(h,s+c);this.components.push(u)}}}catch(d){a.e(d)}finally{a.f()}e.addChunkProcessed(o)}return console.log("processArray",e.chunksProcessed[0],e.chunksProcessed.slice(-1)[0],"out of",this.props.store.chunkURLs.length,"chunks"),!0}}]),n}(r.a.Component),O=function(){function e(t,n){Object(c.a)(this,e),this.columnX=t.x,this.compressedColumnX=t.compressedX,this.index=n,this.firstBin=t.first_bin,this.lastBin=t.last_bin,this.arrivals=[];var o,r=Object(l.a)(t.arrivals);try{for(r.s();!(o=r.n()).done;){var s=o.value;this.arrivals.push(new j(s))}}catch(h){r.e(h)}finally{r.f()}this.departures=[];var a,i=Object(l.a)(t.departures);try{for(i.s();!(a=i.n()).done;){var p=a.value;this.departures.push(new j(p))}}catch(h){i.e(h)}finally{i.f()}this.relativePixelX=-1,this.occupants=t.occupants,this.matrix=t.matrix,this.num_bin=this.lastBin-this.firstBin+1}return Object(h.a)(e,[{key:"getColumnX",value:function(e){return e?this.compressedColumnX:this.columnX}}]),e}(),j=function(){function e(t){Object(c.a)(this,e),this.upstream=t.upstream,this.downstream=t.downstream,this.participants=t.participants,this.key=this.edgeToKey()}return Object(h.a)(e,[{key:"edgeToKey",value:function(){return String(this.downstream).padStart(13,"0")+String(this.upstream).padStart(13,"0")}}]),e}(),w=x,E=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(c.a)(this,n);for(var o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={color:e.props.color},e}return Object(h.a)(n,[{key:"render",value:function(){return r.a.createElement(g.Rect,{x:this.props.x,y:this.props.y,width:this.props.width,height:this.props.height||1,fill:this.state.color})}}]),n}(r.a.Component),P=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"onHover",value:function(e){var t=Math.floor(Math.max(0,e.evt.layerX-this.props.x)/this.props.store.pixelsPerColumn),n=this.props.range[Math.min(this.props.range.length-1,t)],o='"';o+=(this.props.pathName.startsWith("NC_045512")?"Reference: "+this.props.pathName:this.props.pathName)+'"\nCoverage: '+n[0]+"\nInversion: "+n[1]+"\nPos: ";for(var r=n[2],s=0;s<r.length;s++){var a=r[s][0],i=r[s][1],l="";l=0===a?i+"+":0===i?a+"-":a+"-"+i,s>0&&(l=","+l),o+=l}void 0!==this.props.store.metaData.get(this.props.pathName)&&(o+="\n"+this.props.store.metaData.get(this.props.pathName).Info),this.props.store.updateCellTooltipContent(o)}},{key:"onLeave",value:function(){this.props.store.updateCellTooltipContent("")}},{key:"inversionText",value:function(e){return this.props.store.pixelsPerRow>9&&e?r.a.createElement(g.Text,{x:this.props.x,y:this.props.y,width:this.props.width,height:this.props.height||1,align:"center",verticalAlign:"center",text:e?"<":" ",onMouseOver:this.onHover.bind(this),onMouseLeave:this.onLeave.bind(this)}):null}},{key:"render",value:function(){if(void 0===this.props.range||0===this.props.range.length)return null;var e=this.props.range[0][1]>.5,t=this.props.range[0][0],n=this.props.color;return t>1&&!e&&(n=t<10?this.props.store.copyNumberColorArray[t]:this.props.store.copyNumberColorArray[10]),e&&(n=t<10?this.props.store.invertedColorArray[t]:this.props.store.invertedColorArray[10]),r.a.createElement(r.a.Fragment,null,r.a.createElement(g.Rect,{x:this.props.x,y:this.props.y,width:this.props.width,height:this.props.height||1,fill:n,onMouseMove:this.onHover.bind(this),onMouseLeave:this.onLeave.bind(this)}),this.inversionText(e))}}]),n}(r.a.Component),L=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e){var o;return Object(c.a)(this,n),(o=t.call(this,e)).width=e.row.length,o}return Object(h.a)(n,[{key:"render",value:function(){var e=this;if(!this.props.row.length||!this.props.iColumns.length)return null;for(var t=this.props.iColumns[0]-1,n=[],o={width:0,x:this.props.iColumns[0],range:[]},s=0;s<this.props.iColumns.length;s++){var a=this.props.iColumns[s];a===t+1?(o.width+=1,o.range.push(this.props.row[s])):(n.push(o),o={width:1,x:a,range:[this.props.row[s]]}),t=a}return n.push(o),r.a.createElement(r.a.Fragment,null,n.map((function(t){return r.a.createElement(P,{key:"span"+e.props.rowNumber+","+t.x,range:t.range,store:e.props.store,pathName:e.props.pathName,color:e.props.color,x:e.props.x+t.x*e.props.store.pixelsPerColumn,y:e.props.y,rowNumber:e.props.rowNumber,width:t.width*e.props.store.pixelsPerColumn,height:e.props.store.pixelsPerRow})})))}}]),n}(r.a.Component);function N(e,t){return e+t}function S(e,t){return 0===e.length&&0===t.length||e.length===t.length&&e.every((function(e){return t.indexOf(e)>-1}))}function M(e,t,n){return e<t?e=t:e>n&&(e=n),e}function B(e){var t;return!isNaN(e)&&(0|(t=parseFloat(e)))===t}function _(e,t,n){var o=n||t,r=(e.downstream+1)*(e.upstream+1);if(o){var s=(o.downstream+1)*(o.upstream+1);return!t&&!n||r===s?[R(r),1,t||n?"black":null]:["gray",.3,null]}return[R(r),1,null]}function R(e){e=e.toString();for(var t=0,n=0;n<e.length;n++)t=e.charCodeAt(n)+((t<<5)-t);for(var o="#",r=0;r<3;r++){o+=("00"+(t>>8*r&255).toString(16)).substr(-2)}return o}function F(e){for(var t=e.length,n=-1/0;t--;)n=e[t]>n?e[t]:n;return n}var T=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(){var e;Object(c.a)(this,n);for(var o=arguments.length,r=new Array(o),s=0;s<o;s++)r[s]=arguments[s];return(e=t.call.apply(t,[this].concat(r))).state={color:"lightgray"},e.handleClick=function(){"lightgray"===e.state.color?e.setState({color:"lightblue"}):"lightblue"===e.state.color&&e.setState({color:"lightgray"})},e}return Object(h.a)(n,[{key:"renderMatrix",value:function(){var e=this,t=this.props.item.matrix.map((function(t,n){var o=t[0];return e.renderMatrixRow(t[1],n,o)}));return this.props.store.updateMaxHeight(this.props.item.occupants.length),r.a.createElement(r.a.Fragment,null,t)}},{key:"renderMatrixRow",value:function(e,t,n){var o=t;if(!this.props.store.useVerticalCompression){if(!this.props.compressed_row_mapping.hasOwnProperty(n))return null;o=this.props.compressed_row_mapping[n]}var s=this.props.pathNames[n],a="#838383";if(this.props.store.colorByGeneAnnotation&&this.props.store.metaData){var i=this.props.store.metaData;void 0!==i.get(s)&&(a=i.get(s).Color.startsWith("#")?i.get(s).Color:function(e){e=e.toString();for(var t=0,n=0;n<e.length;n++)t=e.charCodeAt(n)+((t<<5)-t);for(var o="#",r=0;r<3;r++){o+=("00"+(t>>8*r&255).toString(16)).substr(-2)}return o}(i.get(s).Color))}return r.a.createElement(L,{key:"occupant"+n,row:e[1],iColumns:e[0],parent:this.props.item,store:this.props.store,pathName:s,color:a,x:this.props.item.relativePixelX+this.props.item.arrivals.length*this.props.store.pixelsPerColumn,y:o*this.props.store.pixelsPerRow+this.props.store.topOffset,rowNumber:n,verticalRank:t})}},{key:"renderAllConnectors",value:function(){var e=this,t=this.props.item.departures,n=t.slice(-1)[0];if(void 0!==n){var o=t.slice(0,-1).map((function(e){return e.participants.length})).reduce(N,0);return r.a.createElement(r.a.Fragment,null,n.participants.map((function(t){return o++,e.renderComponentConnector(o,t)})))}return null}},{key:"renderComponentConnector",value:function(e,t){var n=this.props.item,o=n.relativePixelX+(n.arrivals.length+(this.props.store.useWidthCompression?this.props.store.binScalingFactor:n.num_bin)+n.departures.length-1)*this.props.store.pixelsPerColumn,s=e;return this.props.store.useVerticalCompression||(s=this.props.compressed_row_mapping[t]),r.a.createElement(E,{key:"connector"+t,x:o,y:this.props.store.topOffset+s*this.props.store.pixelsPerRow,width:this.props.store.pixelsPerColumn,height:this.props.store.pixelsPerRow,color:"#AAAABE"})}},{key:"render",value:function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement(g.Rect,{x:this.props.item.relativePixelX,y:this.props.store.topOffset,key:this.state.key+"R",width:this.props.widthInColumns*this.props.store.pixelsPerColumn,height:this.props.height-2,fill:this.state.color,onClick:this.handleClick,onMouseOver:this.onHover.bind(this),onMouseLeave:this.onLeave.bind(this)}),this.props.store.useWidthCompression?null:this.renderMatrix(),this.props.store.useConnector?this.renderAllConnectors():null)}},{key:"onHover",value:function(){this.props.store.updateCellTooltipContent("Bin range: "+this.props.item.firstBin+" - "+this.props.item.lastBin)}},{key:"onLeave",value:function(){this.props.store.updateCellTooltipContent("")}}]),n}(r.a.Component),A=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"renderMatrixRow",value:function(){for(var e=this.props.item,t=e.relativePixelX+e.arrivals.length*this.props.store.pixelsPerColumn,n=[],o=0;o<this.props.item.num_bin;o++)n.push(r.a.createElement(g.Text,{key:"nuc_text"+o,x:t+o*this.props.store.pixelsPerColumn,y:this.props.store.topOffset-this.props.store.pixelsPerColumn,text:this.props.nucleotides[o],align:"center",height:this.props.store.pixelsPerColumn,width:this.props.store.pixelsPerColumn,fontSize:this.props.store.pixelsPerColumn+2}));return n}},{key:"render",value:function(){return this.renderMatrixRow()}}]),n}(r.a.Component),I=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e){var o;return Object(c.a)(this,n),(o=t.call(this,e)).handleMouseOut=o.handleMouseOut.bind(Object(u.a)(o)),o.handleMouseOver=o.handleMouseOver.bind(Object(u.a)(o)),o}return Object(h.a)(n,[{key:"handleMouseOver",value:function(){this.props.updateHighlightedNode(this.props.item)}},{key:"handleMouseOut",value:function(){this.props.updateHighlightedNode(null)}},{key:"linkCells",value:function(){var e,t,n=this;return this.props.store.useVerticalCompression?(e=0,t=this.props.item.participants.length,Object(i.a)(Array(1+t-e).keys()).map((function(t){return e+t}))).map((function(e){return e*n.props.store.pixelsPerRow})):this.props.item.participants.map((function(e){return n.props.compressed_row_mapping[e]*n.props.store.pixelsPerRow}))}},{key:"componentDidMount",value:function(){this.setState({color:this.props.color})}},{key:"render",value:function(){var e=this,t=this.linkCells();return r.a.createElement(r.a.Fragment,null,t.map((function(t,n){return r.a.createElement(g.Rect,{key:"dot"+n,x:e.props.x,y:e.props.store.topOffset+t,width:e.props.store.pixelsPerColumn,height:e.props.store.pixelsPerRow,fill:e.props.color,opacity:e.props.opacity,stroke:e.props.stroke,onMouseOver:e.handleMouseOver,onMouseOut:e.handleMouseOut})})))}}]),n}(r.a.Component);function W(e){return!Number.isFinite(e)}var H=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e){var o;return Object(c.a)(this,n),(o=t.call(this,e)).handleMouseOver=function(){o.props.store.updateCellTooltipContent("Bin upstream: "+o.props.link.linkColumn.upstream+"\nBin downstream: "+o.props.link.linkColumn.downstream),o.props.updateHighlightedNode(o.props.link.linkColumn)},o.handleMouseOut=function(){o.props.store.updateCellTooltipContent(""),o.props.updateHighlightedNode(null)},o.handleClick=function(e){console.log("Click",e,o.props.link),o.props.updateSelectedLink(o.props.link.linkColumn)},o.arrowXCoord=null,o.points=[],o.handleMouseOut=o.handleMouseOut.bind(Object(u.a)(o)),o.handleMouseOver=o.handleMouseOver.bind(Object(u.a)(o)),o}return Object(h.a)(n,[{key:"componentDidUpdate",value:function(){}},{key:"calculatePoints",value:function(){var e=this.props.link;this.arrowXCoord=this.props.link.xArrival;var t=this.props.link.xDepart-this.arrowXCoord+this.props.store.pixelsPerColumn/2,n=this.props.store.pixelsPerColumn/2,o=t<0?-1:1,r=[t,this.props.store.pixelsPerColumn-2],s=[t-o,2-e.elevation],a=[t-6*o,-e.elevation],i=[n+6*o,-e.elevation],l=[n+o,2-e.elevation],p=[n,-5];this.points=[r[0],r[1],s[0],s[1],a[0],a[1],i[0],i[1],l[0],l[1],p[0],p[1],n,-1],Math.abs(t)<=this.props.store.pixelsPerColumn&&(e.isArrival?this.points=[n,-10,n,-2]:this.points=[r[0],-2+this.props.store.pixelsPerColumn,r[0],-5]),(this.points.some(isNaN)||this.points.some(W))&&console.log("Some points are NaN: "+this.points)}},{key:"render",value:function(){return this.calculatePoints(),r.a.createElement(g.Arrow,{x:this.arrowXCoord,y:this.props.store.topOffset-this.props.store.pixelsPerColumn,width:this.props.store.pixelsPerColumn,points:this.points,bezier:!1,strokeWidth:this.props.store.pixelsPerColumn,fill:this.props.color,stroke:this.props.color,opacity:this.props.opacity,"stroke-opacity":this.props.opacity,pointerLength:1,pointerWidth:1,tension:1/3,onMouseOver:this.handleMouseOver,onMouseOut:this.handleMouseOut,onClick:this.handleClick})}}]),n}(r.a.Component),z=function(){function e(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:0,o=arguments.length>2&&void 0!==arguments[2]?arguments[2]:0,r=arguments.length>3?arguments[3]:void 0;Object(c.a)(this,e),this.linkColumn=t,void 0===t&&console.log(t,n,o),this.xArrival=n,this.xDepart=o,this.elevation=10,this.isArrival=r}return Object(h.a)(e,[{key:"distance",value:function(){return Math.abs(this.xDepart-this.xArrival)||1}}]),e}();function X(e,t,n,o,r,s,a){for(var p={},c=0;c<e.length;c++){var h=e[c];if(h.index in a){for(var u=0;u<h.arrivals.length;u++){var d=h.arrivals[u],m=s(h,c,0,u),g=d.key;g in p?p[g].xArrival=m:p[g]=new z(d,m,m,!0)}for(var f=0;f<h.departures.length-1;f++){var v=h.departures[f],b=s(h,c,h.arrivals.length+(o?r:h.num_bin),f),y=v.key;y in p?p[y].xDepart=b:p[y]=new z(v,b,b,!1)}}}return function(e,t,n){var o=Object.values(e).sort((function(e,t){return e.distance()-t.distance()})),r=function(e,t,n){var o,r=Math.max(0,F(e.map((function(e){return Math.max(e.xDepart,e.xArrival)})))),s=new Array(r).fill(15),a=Object(l.a)(e);try{for(a.s();!(o=a.n()).done;){var p=o.value,c=Math.max(0,Math.min(p.xArrival,p.xDepart)),h=Math.max(p.xArrival,p.xDepart,c+1),u=s.slice(c,h+1),d=u.length?Math.max.apply(Math,Object(i.a)(u)):10;!isNaN(d)&&Number.isFinite(d)||console.log("Bad elevation",p,c,h,u,s);d+=t;for(var m=c;m<h&&m<s.length;m++)s[m]=d;p.elevation=d}}catch(g){a.e(g)}finally{a.f()}return s}(o,t),s=3*t;r.length>0&&(s+=F(r));return[o,s]}(p,t)}var U,Z=n(45),D=n(105),J=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){var e=this;return r.a.createElement(Z.a,{visible:!0,offsetX:15,offsetY:-20,style:{background:"white",zIndex:4,whiteSpace:"pre-line"}},r.a.createElement(D.a,null,(function(){return r.a.createElement("span",null,e.props.store.cellToolTipContent)})))}}]),n}(r.a.Component),V=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"shift",value:function(e){var t=this.props.store.getBeginBin(),n=this.props.store.getEndBin(),o=n-t,r=Math.floor(o*(e/100));console.log(n+"-"+t+"="+o+" --\x3e diff: "+r),this.props.store.updateBeginEndBin(t+r,n+r)}},{key:"handleJump",value:function(){console.log("JUMP: path name: "+this.props.store.pathNucPos.path+" nucleotide position: "+this.props.store.pathNucPos.nucPos);var e=this.props.store;!function(e,t){C.apply(this,arguments)}(e.pathIndexServerAddress+e.pathNucPos.path+"/"+e.pathNucPos.nucPos,(function(t){if("0"===t)alert("The jump query returned 0. Either your path does not exist or your position in the path is wrong. Please try again.");else{console.log(t),t=parseInt(t);var n=Math.ceil(t/e.getBinWidth());console.log(n),e.updateBeginEndBin(n,e.getEndBin())}}))}},{key:"change_zoom_level",value:function(e){console.log("change_zoom_level: "+e.value+" ---"+e.options[e.selectedIndex].text),this.props.store.setIndexSelectedZoomLevel(parseInt(e.value))}},{key:"decIndexSelectedZoomLevel",value:function(){var e=this.props.store.indexSelectedZoomLevel;e>0&&this.props.store.setIndexSelectedZoomLevel(e-1)}},{key:"incIndexSelectedZoomLevel",value:function(){var e=this.props.store.indexSelectedZoomLevel;e<this.props.store.availableZoomLevels.length-1&&this.props.store.setIndexSelectedZoomLevel(e+1)}},{key:"render",value:function(){var e=this;return r.a.createElement("div",{className:"row"},"Jump to path at nucleotide position:",r.a.createElement("input",{type:"string",list:"path",placeholder:"path",onChange:function(t){return e.props.store.updatePathNucPos(t.target.value,e.props.store.pathNucPos.nucPos)},style:{width:"80px"}}),r.a.createElement("datalist",{id:"path"},this.props.schematic.pathNames.map((function(e,t){return r.a.createElement("option",{key:t,value:e})}))),"-",r.a.createElement("input",{type:"number",placeholder:"position",onChange:function(t){return e.props.store.updatePathNucPos(e.props.store.pathNucPos.path,t.target.value)},style:{width:"80px"}}),r.a.createElement("span",{style:{marginLeft:"2px"}},r.a.createElement("button",{className:"button",onClick:function(){return e.handleJump()}},"Jump"))),r.a.createElement("div",{id:"button-container"},r.a.createElement("input",{type:"text",defaultValue:this.props.store.jsonName,style:{width:"330px"},onChange:this.props.store.tryJSONpath,title:"File:"}),r.a.createElement("span",{style:{marginLeft:"30px"}},r.a.createElement(D.a,null,(function(){return r.a.createElement(r.a.Fragment,null,"Bin width:",r.a.createElement("button",{className:"button",onClick:function(){return e.decIndexSelectedZoomLevel()}},"-"),r.a.createElement("select",{id:"select_bin_width",onChange:function(t){return e.change_zoom_level(t.target)},value:e.props.store.indexSelectedZoomLevel},e.props.store.availableZoomLevels.map((function(e,t){return r.a.createElement("option",{key:t,value:t},e)}))),r.a.createElement("button",{className:"button",onClick:function(){return e.incIndexSelectedZoomLevel()}},"+"))}))),r.a.createElement("span",{style:{marginLeft:"30px"}},r.a.createElement("button",{className:"button",onClick:function(){return e.shift(-100)}},"<<"),r.a.createElement("button",{className:"button",onClick:function(){return e.shift(-50)}},"<"),"Pangenome Bin Position:",r.a.createElement(D.a,null,(function(){return r.a.createElement(r.a.Fragment,null,r.a.createElement("input",{type:"number",value:e.props.store.beginEndBin[0],onChange:function(t){return e.props.store.updateBeginEndBin(t.target.value,e.props.store.getEndBin())},style:{width:"80px"}}),"-",r.a.createElement("input",{type:"number",value:e.props.store.beginEndBin[1],readOnly:!0,style:{width:"80px"}}))})),r.a.createElement("button",{className:"button",onClick:function(){return e.shift(50)}},">"),r.a.createElement("button",{className:"button",onClick:function(){return e.shift(100)}},">>")),r.a.createElement("div",{className:"row"},"Jump to path at nucleotide position:",r.a.createElement("span",{className:"myarrow"},r.a.createElement("input",{type:"string",list:"path",name:"path",placeholder:"path",id:"#show-suggestions",onChange:function(t){return e.props.store.updatePathNucPos(t.target.value,e.props.store.pathNucPos.nucPos)},style:{width:"80px"}})),r.a.createElement("datalist",{id:"path"},this.props.schematic.pathNames.map((function(e,t){return r.a.createElement("option",{key:t,value:e})}))),"-",r.a.createElement("input",{type:"number",placeholder:"position",onChange:function(t){return e.props.store.updatePathNucPos(e.props.store.pathNucPos.path,t.target.value)},style:{width:"80px"}}),r.a.createElement("span",{style:{marginLeft:"2px"}},r.a.createElement("button",{className:"button",onClick:function(){return e.handleJump()}},"Jump")),r.a.createElement("span",{style:{marginLeft:"30px"}},"Pangenome Last Bin: ",this.props.store.last_bin_pangenome),r.a.createElement("span",{style:{marginLeft:"30px"}},"Num. of individuals: ",this.props.schematic.pathNames.length-11)),r.a.createElement("div",{className:"row"},r.a.createElement("span",null," ","Allele Frequency Histogram:",r.a.createElement(q,{store:this.props.store})),r.a.createElement("span",null," ","Show Only Rearrangements:",r.a.createElement(K,{store:this.props.store})),this.props.store.useWidthCompression?r.a.createElement(r.a.Fragment,null,r.a.createElement("span",null," ","Render Connectors:",r.a.createElement(G,{store:this.props.store}))):r.a.createElement(r.a.Fragment,null),r.a.createElement("span",null," ","Row Height:",r.a.createElement(D.a,null,(function(){return r.a.createElement("input",{type:"number",min:1,value:e.props.store.pixelsPerRow,onChange:e.props.store.updateHeight,style:{width:"30px"}})}))),r.a.createElement("span",null," ","Column Width:",r.a.createElement("input",{type:"number",min:1,value:this.props.store.pixelsPerColumn,onChange:this.props.store.updateWidth,style:{width:"30px"}})),r.a.createElement("span",null,"\xa0",r.a.createElement("a",{href:"https://github.com/graph-genome/Schematize/wiki",target:"_blank",rel:"noopener noreferrer"},r.a.createElement("strong",null,"Pantograph Tutorial"))),r.a.createElement("span",null,"\xa0 \xa0 \xa0",r.a.createElement("a",{href:"http://covid-19.genenetwork.org/",target:"_blank",rel:"noopener noreferrer"},r.a.createElement("strong",null,"Source Dataset")))))}}]),n}(r.a.Component),q=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){var e=this;return r.a.createElement(D.a,null,(function(){return r.a.createElement("input",{type:"checkbox",checked:e.props.store.useVerticalCompression,onChange:e.props.store.toggleUseVerticalCompression})}))}}]),n}(r.a.Component),G=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){var e=this;return r.a.createElement(D.a,null,(function(){return r.a.createElement("input",{type:"checkbox",checked:e.props.store.useConnector,onChange:e.props.store.toggleUseConnector})}))}}]),n}(r.a.Component),K=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(){return Object(c.a)(this,n),t.apply(this,arguments)}return Object(h.a)(n,[{key:"render",value:function(){var e=this;return r.a.createElement(D.a,null,(function(){return r.a.createElement("input",{type:"checkbox",checked:e.props.store.useWidthCompression,onChange:e.props.store.toggleUseWidthCompression})}))}}]),n}(r.a.Component),Y=V;function $(){return r.a.createElement("img",{src:"/Schematize/Schematize legend.gif",alt:"legend",style:{position:"fixed",bottom:"20px",left:"20px",background:"white",align:"right",width:"100px",height:"200px"}})}var Q=function(e){Object(d.a)(n,e);var t=Object(m.a)(n);function n(e){var o;return Object(c.a)(this,n),(o=t.call(this,e)).layerRef=r.a.createRef(),o.layerRef2=r.a.createRef(),o.layerNavigationBar=r.a.createRef(),o.timerHighlightingLink=null,o.timerSelectionLink=null,o.componentDidMount=function(){var e=document.getElementById("button-container").clientHeight;document.getElementsByClassName("konvajs-content")[0].style.position="relative",o.setState({buttonsHeight:e}),o.layerRef.current.getCanvas()._canvas.id="cnvs",o.layerRef.current.getCanvas()._canvas.position="relative",o.layerRef2.current.getCanvas()._canvas.id="arrow",o.layerRef2.current.getCanvas()._canvas.position="relative"},o.updateHighlightedNode=function(e){o.state.selectedLink||(null!=e?(clearTimeout(o.timerHighlightingLink),o.state.highlightedLink!==e&&(o.timerHighlightingLink=setTimeout((function(){o._updateHighlightedNode(e)}),600))):(clearTimeout(o.timerHighlightingLink),null!=o.state.highlightedLink&&(o.timerHighlightingLink=setTimeout((function(){o._updateHighlightedNode(e)}),600))))},o.updateSelectedLink=function(e){console.log("updateSelectedLink");var t=!1;if(e){var n=[e.upstream,e.downstream].sort((function(e,t){return e-t})),r=Object(p.a)(n,2),s=r[0],a=r[1];if(0===Object.values(U).length)return;var i=Object.values(U).slice(-1)[0].lastBin,l=Object(p.a)(o.props.store.beginEndBin,2),c=l[0],h=l[1];if(s<c||a>i){console.log("updateSelectedLink - NewBeginEndBin");var u=Math.abs(c-s)>Math.abs(h-a),d=Object(p.a)(o.props.store.beginEndBin,2),m=d[0],g=d[1],f=h-c,v=Math.floor(f/2);u?(m=s-v,g=s+v):(m=a-v,g=a+v),o.props.store.updateBeginEndBin(m,g),t=!0}}clearTimeout(o.timerHighlightingLink),(e!==o.selectedLink||t)&&(console.log("updateSelectedLink - NewSelection"),o.setState({highlightedLink:e,selectedLink:e})),e&&(console.log("Timer deselection"),clearTimeout(o.timerSelectionLink),o.timerSelectionLink=setTimeout((function(){o.updateSelectedLink(null)}),5e3))},o.renderNucleotidesSchematic=function(){if(!o.props.store.loading&&1===o.props.store.getBinWidth()&&!o.props.store.useWidthCompression&&o.props.store.pixelsPerColumn>=10&&o.schematic.nucleotides.length>0)return Object.values(U).map((function(e,t){var n=o.schematic.components[0].firstBin||1,s=o.schematic.nucleotides.slice(e.firstBin-n,e.lastBin-n+1);return r.a.createElement(r.a.Fragment,{key:"nt"+t},r.a.createElement(A,{store:o.props.store,item:e,key:t,nucleotides:s}))}))},o.handleClick=function(e){o.props.store.updateBeginEndBin(Math.max(Math.floor(o.props.store.last_bin_pangenome*e.evt.offsetX/(e.currentTarget.attrs.width+e.currentTarget.attrs.strokeWidth)),1),o.props.store.getEndBin())},o.handleMouseMove=function(e){o.props.store.updateCellTooltipContent("Go to bin: "+Math.max(Math.floor(o.props.store.last_bin_pangenome*e.evt.offsetX/(e.currentTarget.attrs.width+e.currentTarget.attrs.strokeWidth)),1))},o.handleMouseOut=function(){o.props.store.updateCellTooltipContent("")},o.state={schematize:[],pathNames:[],actualWidth:1,buttonsHeight:0},o.schematic=new w({store:o.props.store}),Object(f.s)(o.props.store.chunkURLs,o.fetchAllChunks.bind(Object(u.a)(o))),Object(f.s)(o.props.store,"useVerticalCompression",o.updateSchematicMetadata.bind(Object(u.a)(o))),Object(f.s)(o.props.store,"useWidthCompression",o.openRelevantChunksFromIndex.bind(Object(u.a)(o))),Object(f.s)(o.props.store,"useConnector",o.recalcXLayout.bind(Object(u.a)(o))),Object(f.s)(o.props.store,"pixelsPerColumn",o.openRelevantChunksFromIndex.bind(Object(u.a)(o))),Object(f.s)(o.props.store,"pixelsPerRow",o.recalcY.bind(Object(u.a)(o))),Object(f.s)(o.props.store.chunksProcessed,o.updateSchematicMetadata.bind(Object(u.a)(o))),Object(f.s)(o.props.store.chunksProcessedFasta,o.updateSchematicMetadata.bind(Object(u.a)(o))),Object(f.s)(o.props.store,"loading",o.render.bind(Object(u.a)(o))),Object(f.s)(o.props.store,"chunkIndex",o.openRelevantChunksFromIndex.bind(Object(u.a)(o))),Object(f.s)(o.props.store,"indexSelectedZoomLevel",o.openRelevantChunksFromIndex.bind(Object(u.a)(o))),Object(f.s)(o.props.store.beginEndBin,(function(){console.log("Updated Begin and End bin: "+o.props.store.beginEndBin),o.openRelevantChunksFromIndex()})),o}return Object(h.a)(n,[{key:"prepareWhichComponentsToVisualize",value:function(e){U={};var t,n=this.props.store.getBeginBin(),o=this.props.store.getEndBin(),r=-1,s=Object(l.a)(this.schematic.components);try{for(s.s();!(t=s.n()).done;){var a=t.value;if(a.lastBin>=n){var i=a.getColumnX(this.props.store.useWidthCompression);if(-1===r&&(r=i,e+=this._column_shift(a)),i-r>=e)break;U[a.index]=a,o=a.lastBin}}}catch(p){s.e(p)}finally{s.f()}return o}},{key:"openRelevantChunksFromIndex",value:function(){if(console.log("STEP #3: with new chunkIndex, this.openRelevantChunksFromIndex()"),null!==this.props.store.chunkIndex&&this.props.store.chunkIndex.zoom_levels.keys()){var e=this.props.store.getBeginBin();this.props.store.setAvailableZoomLevels(this.props.store.chunkIndex.zoom_levels.keys());var t=window.innerWidth/this.props.store.pixelsPerColumn,n=this.props.store.getSelectedZoomLevel(),o=function(e,t,n,o){for(var r=[],s=[],a=-1,i=n.chunkIndex.zoom_levels.get(t),l=0;l<i.files.length;l++){var p=i.files[l];if(p.last_bin>=e){var c=n.useWidthCompression?p.compressedX:p.x;if(-1===a&&(a=c),r.push(p.file),null!==p.fasta&&s.push(p.fasta),c-a>=o)break}}return[r,s]}(e,n,this.props.store,t),r=Object(p.a)(o,2),s=r[0],a=r[1];this.props.store.setLastBinPangenome(this.props.store.chunkIndex.zoom_levels.get(n).last_bin);var i=this.props.store.getSelectedZoomLevel(!0)/this.props.store.getSelectedZoomLevel();if(1!==i)this.props.store.updateBeginEndBin(Math.round((e-1)*i),Math.round((this.props.store.getEndBin()-1)*i));else{var l=this.prepareWhichComponentsToVisualize(t);this.props.store.updateBeginEndBin(e,l);var c="https://collections.lugli.arvadosapi.com/c=lugli-4zz18-8byz5m8v3udnj8a/t=1km3sd1jsgrj3pr5n4pp7raza4djg72tygcg3dym3ta1ty3ewx/_/"+this.props.store.jsonName+"/"+n+"/";s=s.map((function(e){return c+e})),a=a.map((function(e){return c+e})),this.props.store.switchChunkFastaURLs(a),this.props.store.switchChunkURLs(s)||this.recalcXLayout()}}}},{key:"fetchAllChunks",value:function(){var e=this;if(console.log("STEP #5: once ChunkURLs are listed, go fetchAllChunks"),this.props.store.chunkURLs.get(0)){var t,n=Object(l.a)(this.props.store.chunkURLs);try{var o=function(){var n=t.value;e.schematic.jsonFetch(n).then((function(t){e.schematic.loadJsonCache(n,t)}))};for(n.s();!(t=n.n()).done;)o()}catch(r){n.e(r)}finally{n.f()}}else console.warn("No chunk URL defined.")}},{key:"updateSchematicMetadata",value:function(){var e=this;if(S(this.props.store.chunkURLs,this.props.store.chunksProcessed)&&S(this.props.store.chunkFastaURLs,this.props.store.chunksProcessedFasta)){console.log("updateSchematicMetadata #components: "+this.schematic.components.length),console.log("STEP #8: chunksProcessed finishing triggers updateSchematicMetadata with final rendering info for this loaded chunks");var t=this.prepareWhichComponentsToVisualize(window.innerWidth/this.props.store.pixelsPerColumn);this.props.store.updateBeginEndBin(this.props.store.getBeginBin(),t),this.setState({schematize:this.schematic.components,pathNames:this.schematic.pathNames},(function(){e.recalcXLayout(),e.compressed_row_mapping=function(e,t,n){var o,r=new Set,s=Object(l.a)(e);try{for(s.s();!(o=s.n()).done;){var a,i=o.value,c=Object(l.a)(i.occupants);try{for(c.s();!(a=c.n()).done;){var h=a.value;r.add(h)}}catch(L){c.e(L)}finally{c.f()}}}catch(L){s.e(L)}finally{s.f()}var u={},d={};if(n.length>0){var m,g=new Set,f=Object(l.a)(n);try{for(f.s();!(m=f.n()).done;){var v=m.value;g.add(t.indexOf(v))}}catch(L){f.e(L)}finally{f.f()}var b,y=[],k=[],C=t.indexOf("NC_045512"),x=Object(l.a)(r);try{for(x.s();!(b=x.n()).done;){var O=b.value;O!==C&&(g.has(O)?y.push(O):k.push(O))}}catch(L){x.e(L)}finally{x.f()}C>=0&&y.push(C),d=y.concat(k)}else d=Array.from(r).sort();var j,w=Object(l.a)(d.entries());try{for(w.s();!(j=w.n()).done;){var E=Object(p.a)(j.value,2),P=E[0];u[E[1]]=P}}catch(L){w.e(L)}finally{w.f()}return u}(e.schematic.components,e.schematic.pathNames,Array.from(e.props.store.metaData.keys())),e.maxNumRowsAcrossComponents=e.calcMaxNumRowsAcrossComponents(e.schematic.components),e.props.store.setLoading(!1)}))}}},{key:"recalcXLayout",value:function(){console.log("recalcXLayout");var e,t=Object(l.a)(this.schematic.components.entries());try{for(t.s();!(e=t.n()).done;){var n=Object(p.a)(e.value,2),o=n[0],r=n[1];r.relativePixelX=this.leftXStart(r,o,0,0)}}catch(m){t.e(m)}finally{t.f()}var s=0;if(Object.values(U).length>0){var a=Object.values(U)[0],i=Object.values(U)[Object.values(U).length-1];s=(i.getColumnX(this.props.store.useWidthCompression)-a.getColumnX(this.props.store.useWidthCompression)+i.arrivals.length+i.departures.length+(this.props.store.useWidthCompression?this.props.store.binScalingFactor:i.num_bin)-this._column_shift(a))*this.props.store.pixelsPerColumn}this.setState({actualWidth:s});var c=X(this.schematic.components,this.props.store.pixelsPerColumn,this.props.store.topOffset,this.props.store.useWidthCompression,this.props.store.binScalingFactor,this.leftXStart.bind(this),U),h=Object(p.a)(c,2),u=h[0],d=h[1];this.distanceSortedLinks=u,this.props.store.updateTopOffset(parseInt(d))}},{key:"recalcY",value:function(){this.setState({highlightedLink:null})}},{key:"calcMaxNumRowsAcrossComponents",value:function(e){var t=e.map((function(e){return e.occupants.length}));return Math.max.apply(Math,Object(i.a)(t))}},{key:"visibleHeightPixels",value:function(){return void 0===U?0:this.props.store.useVerticalCompression||!this.compressed_row_mapping?(void 0===this.maxNumRowsAcrossComponents&&(this.maxNumRowsAcrossComponents=this.calcMaxNumRowsAcrossComponents(Object.values(U))),(this.maxNumRowsAcrossComponents+1)*this.props.store.pixelsPerRow):(Object.keys(this.compressed_row_mapping).length+.25)*this.props.store.pixelsPerRow}},{key:"_updateHighlightedNode",value:function(e){this.setState({highlightedLink:e})}},{key:"_column_shift",value:function(e){return this.props.store.useWidthCompression||e.firstBin===this.props.store.getBeginBin()?0:e.arrivals.length+(this.props.store.getBeginBin()-e.firstBin)}},{key:"leftXStart",value:function(e,t,n,o){if(e.index in U){var r=Object.values(U)[0];return(e.getColumnX(this.props.store.useWidthCompression)-r.getColumnX(this.props.store.useWidthCompression)-this._column_shift(r)-(e.index-this.schematic.components[0].index)+n+o)*this.props.store.pixelsPerColumn+t*this.props.store.pixelsPerColumn}}},{key:"renderComponent",value:function(e,t,n){var o=this;return r.a.createElement(r.a.Fragment,null,r.a.createElement(T,{store:this.props.store,item:e,key:"r"+t,height:this.visibleHeightPixels(),widthInColumns:e.arrivals.length+(this.props.store.useWidthCompression?this.props.store.binScalingFactor:e.num_bin)+(e.departures.length-1),compressed_row_mapping:this.compressed_row_mapping,pathNames:n}),e.arrivals.map((function(n,r){return o.renderLinkColumn(e,t,0,r,n)})),e.departures.slice(0,-1).map((function(n,r){var s=e.arrivals.length+(o.props.store.useWidthCompression?o.props.store.binScalingFactor:e.num_bin);return o.renderLinkColumn(e,t,s,r,n)})))}},{key:"renderLinkColumn",value:function(e,t,n,o,s){var a=this.leftXStart(e,t,n,o),i=_(s,this.state.highlightedLink,this.state.selectedLink),l=Object(p.a)(i,3),c=l[0],h=l[1],u=l[2];return r.a.createElement(I,{store:this.props.store,key:"departure"+t+o,item:s,pathNames:this.state.pathNames,x:a,pixelsPerRow:this.props.store.pixelsPerRow,width:this.props.store.pixelsPerColumn,color:c,opacity:h,stroke:u,updateHighlightedNode:this.updateHighlightedNode,compressed_row_mapping:this.compressed_row_mapping})}},{key:"renderLink",value:function(e){var t=_(e.linkColumn,this.state.highlightedLink,this.state.selectedLink),n=Object(p.a)(t,2),o=n[0],s=n[1];return r.a.createElement(H,{store:this.props.store,key:"arrow"+e.linkColumn.key,link:e,color:o,opacity:s,updateHighlightedNode:this.updateHighlightedNode,updateSelectedLink:this.updateSelectedLink})}},{key:"renderSchematic",value:function(){var e=this;if(console.log("renderSchematic"),!this.props.store.loading)return this.schematic.components.map((function(t,n){return t.index in U?r.a.createElement(r.a.Fragment,{key:"f"+n},e.renderComponent(t,n,e.state.pathNames)):null}))}},{key:"renderSortedLinks",value:function(){var e=this;if(!this.props.store.loading)return this.distanceSortedLinks.map((function(t,n){return e.renderLink(t)}))}},{key:"loadingMessage",value:function(){if(this.props.store.loading)return r.a.createElement(g.Text,{key:"loading",y:100,fontSize:60,width:300,align:"center",text:"Loading..."})}},{key:"render",value:function(){console.log("Start render");var e=window.innerWidth-2,t=1===this.props.store.getBeginBin()?0:Math.ceil(this.props.store.getBeginBin()/this.props.store.last_bin_pangenome*e),n=Math.ceil((this.props.store.getEndBin()-this.props.store.getBeginBin()+1)/this.props.store.last_bin_pangenome*e);return t+n>e&&(n=e-t),r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{style:{position:"sticky",top:0,zIndex:"2",background:"white",width:this.state.actualWidth,minWidth:"100%"}},r.a.createElement(Y,{store:this.props.store,schematic:this.schematic}),r.a.createElement(g.Stage,{x:this.props.store.leftOffset,y:this.props.topOffset,style:{cursor:"pointer"},width:e+2,height:this.props.store.heightNavigationBar+4},r.a.createElement(g.Layer,{ref:this.layerNavigationBar},r.a.createElement(g.Rect,{y:2,width:e,height:this.props.store.heightNavigationBar,fill:"lightblue",stroke:"gray",strokeWidth:2,onMouseMove:this.handleMouseMove,onMouseOut:this.handleMouseOut,onClick:this.handleClick}),r.a.createElement(g.Rect,{x:t,y:2,width:n,height:this.props.store.heightNavigationBar,fill:"orange",stroke:"brown",strokeWidth:2,opacity:.7}))),r.a.createElement(g.Stage,{x:this.props.store.leftOffset,y:this.props.topOffset,width:this.state.actualWidth,height:this.props.store.topOffset},r.a.createElement(g.Layer,{ref:this.layerRef2},this.renderSortedLinks(),this.renderNucleotidesSchematic()))),r.a.createElement(g.Stage,{x:this.props.store.leftOffset,y:-this.props.store.topOffset,width:this.state.actualWidth,height:this.visibleHeightPixels()+this.props.store.pixelsPerColumn},r.a.createElement(g.Layer,{ref:this.layerRef},this.loadingMessage(),this.renderSchematic())),r.a.createElement(J,{store:this.props.store}),r.a.createElement($,{store:this.props.store}))}}]),n}(o.Component);Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var ee=n(2),te=ee.a.model({file:ee.a.string,fasta:ee.a.maybeNull(ee.a.string),first_bin:ee.a.integer,last_bin:ee.a.integer,x:ee.a.integer,compressedX:ee.a.integer}),ne=ee.a.model({bin_width:ee.a.integer,last_bin:ee.a.integer,files:ee.a.array(te)}),oe=ee.a.maybeNull(ee.a.model({json_version:14,pangenome_length:ee.a.integer,zoom_levels:ee.a.map(ne)})),re=ee.a.model("PathNucPos",{path:ee.a.string,nucPos:ee.a.integer}),se=ee.a.model({Path:ee.a.identifier,Color:ee.a.string,Info:ee.a.string}),ae=ee.a.model({chunkIndex:oe,beginEndBin:ee.a.optional(ee.a.array(ee.a.integer),[1,100]),useVerticalCompression:!1,useWidthCompression:!1,binScalingFactor:3,useConnector:!0,pixelsPerColumn:10,pixelsPerRow:3,heightNavigationBar:25,leftOffset:1,topOffset:400,highlightedLink:0,maximumHeightThisFrame:150,cellToolTipContent:"",jsonName:"SARS-CoV-2",availableZoomLevels:ee.a.optional(ee.a.array(ee.a.string),["1"]),precIndexSelectedZoomLevel:0,indexSelectedZoomLevel:0,chunkURLs:ee.a.optional(ee.a.array(ee.a.string),[]),chunkFastaURLs:ee.a.optional(ee.a.array(ee.a.string),[]),chunksProcessed:ee.a.optional(ee.a.array(ee.a.string),[]),chunksProcessedFasta:ee.a.optional(ee.a.array(ee.a.string),[]),pathNucPos:ee.a.optional(re,{path:"path",nucPos:0}),pathIndexServerAddress:"https://pantograph.lugli.arvadosapi.com/",loading:!0,copyNumberColorArray:ee.a.optional(ee.a.array(ee.a.string),["#6a6a6a","#5f5f5f","#545454","#4a4a4a","#3f3f3f","#353535","#2a2a2a","#1f1f1f","#151515","#0a0a0a","#000000"]),invertedColorArray:ee.a.optional(ee.a.array(ee.a.string),["#de4b39","#c74333","#b13c2d","#9b3427","#852d22","#6f251c","#581e16","#421611","#2c0f0b","#160705","#000000"]),last_bin_pangenome:0,colorByGeneAnnotation:!0,metaDataKey:"Path",metaData:ee.a.map(se)}).actions((function(e){return{setChunkIndex:function(t){console.log("STEP #2: chunkIndex contents loaded"),e.chunkIndex=null,e.chunkIndex=t},updateBeginEndBin:function(t,n){var o,r;console.log("updateBeginEndBin - "+t+" - "+n),B(t)&&B(n)||(t=1,n=100),t=Math.min(e.last_bin_pangenome-1,Math.max(1,Math.round(t))),o=t,r=n,e.beginEndBin=[o,r]},updateTopOffset:function(t){Number.isFinite(t)&&Number.isSafeInteger(t)&&(e.topOffset=t+10)},updateHighlightedLink:function(t){e.highlightedLink=t},updateMaxHeight:function(t){e.maximumHeightThisFrame=Math.max(e.maximumHeightThisFrame,t)},resetRenderStats:function(){e.maximumHeightThisFrame=1},updateCellTooltipContent:function(t){e.cellToolTipContent=String(t)},updateBinScalingFactor:function(t){var n=t.target.value;e.binScalingFactor=Math.max(1,Number(n))},toggleUseVerticalCompression:function(){e.useVerticalCompression=!e.useVerticalCompression},toggleUseWidthCompression:function(){e.useWidthCompression=!e.useWidthCompression},toggleUseConnector:function(){e.useConnector=!e.useConnector},updateHeight:function(t){e.pixelsPerRow=M(Number(t.target.value),1,30)},updateWidth:function(t){e.pixelsPerColumn=M(Number(t.target.value),3,30)},tryJSONpath:function(t){k("https://collections.lugli.arvadosapi.com/c=lugli-4zz18-8byz5m8v3udnj8a/t=1km3sd1jsgrj3pr5n4pp7raza4djg72tygcg3dym3ta1ty3ewx/_/"+t.target.value+"/bin2file.json")&&(console.log("STEP#1: New Data Source: "+t.target.value),e.jsonName=t.target.value)},switchChunkURLs:function(t){return!S(t,e.chunkURLs)&&(console.log("STEP #4: Set switchChunkURLs: "+t),e.chunkURLs=t,e.chunksProcessed=[],!0)},switchChunkFastaURLs:function(t){S(t,e.chunkFastaURLs)||(console.log("STEP #4.fasta: Set switchChunkFastaURLs: "+t),e.chunkFastaURLs=t,e.chunksProcessedFasta=[])},addChunkProcessed:function(t){console.log("STEP #7: processed "+t),e.chunksProcessed.push(t)},addChunkProcessedFasta:function(t){console.log("STEP #7.FASTA: processed "+t),e.chunksProcessedFasta.push(t)},getBeginBin:function(){return e.beginEndBin[0]},getEndBin:function(){return e.beginEndBin[1]},updatePathNucPos:function(t,n){void 0!==t&&(n=n?Math.abs(parseInt(n)):0,e.pathNucPos={path:t,nucPos:n})},getBinWidth:function(){return Number(e.getSelectedZoomLevel())},getSelectedZoomLevel:function(){var t=arguments.length>0&&void 0!==arguments[0]&&arguments[0],n=e.availableZoomLevels[t?e.precIndexSelectedZoomLevel:e.indexSelectedZoomLevel];return t&&(e.precIndexSelectedZoomLevel=e.indexSelectedZoomLevel),n||"1"},setIndexSelectedZoomLevel:function(t){e.precIndexSelectedZoomLevel=e.indexSelectedZoomLevel,e.indexSelectedZoomLevel=t},setAvailableZoomLevels:function(t){var n=Object(i.a)(t);e.availableZoomLevels=n},setLoading:function(t){e.loading=t},setLastBinPangenome:function(t){e.last_bin_pangenome=t},setMetaData:function(t){for(var n=0,o=Object.entries(t);n<o.length;n++){var r=Object(p.a)(o[n],2),s=r[0],a=r[1];e.metaData.set(s,a)}},getMetaData:function(t){e.metaData.get(t)},setMetaDataChoices:function(t){e.metaDataChoices=t}}})).views((function(e){return{}})).create({});a.a.render(r.a.createElement(Q,{store:ae}),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},42:function(e,t,n){},47:function(e,t,n){e.exports=n(104)},52:function(e,t,n){}},[[47,1,2]]]);
//# sourceMappingURL=main.97c7e845.chunk.js.map